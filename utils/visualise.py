import torchvision.transforms as transforms
import numpy as np
import matplotlib.pyplot as plt
import os
import torch
from utils.others import *
from PIL import Image
import cv2


def tensor2im(input_image, imtype=np.uint8):
    if isinstance(input_image, torch.Tensor):
        image_tensor = input_image.data
    else:
        return input_image
    image_numpy = image_tensor[0].cpu().float().numpy()
    if image_numpy.shape[0] == 1:
        image_numpy = np.tile(image_numpy, (3, 1, 1))
    image_numpy = (np.transpose(image_numpy, (1, 2, 0)) + 1) / 2.0 * 255.0
    return image_numpy.astype(imtype)


def labeltensor_to_PIL(tensor):
    """
    这个用于标签图展示：将tensor转为黑白图片
    :param tensor: [batch=1, c ,h w]
    :return:
    """
    unloader = transforms.ToPILImage()
    image = tensor.cpu().clone()
    image = image.squeeze(0)
    image = unloader(image)
    image = image.convert('1')
    return image


def imgtensor2im(input_image, imtype=np.uint8):
    """
    这个用于原图展示：将tensor转为原始的图片
    :param input_image:
    :param imtype:
    :return:
    """
    if isinstance(input_image, torch.Tensor):
        image_tensor = input_image.data
    else:
        return input_image
    image_numpy = image_tensor[0].cpu().float().numpy()
    if image_numpy.shape[0] == 1:
        image_numpy = np.tile(image_numpy, (3, 1, 1))
    image_numpy = (np.transpose(image_numpy, (1, 2, 0)) + 1) / 2.0 * 255.0
    return image_numpy.astype(imtype)


def display_train_loss(train_ls, k, date):
    """
    :param train_ls:
    :param test_ls:
    :param k: 第k次k折交叉验证
    :return:
    """

    # print('输出每个epoch的loss值:')
    # print('train_ls:{}'.format(train_ls))
    # print('输出train_ls长度：', len(train_ls))
    name = 'k' + str(k) + '_loss'
    name_p = name + '.png'
    x = []
    for i in range(len(train_ls)):
        x.append(i + 1)
    plt.cla()
    plt.close('all')
    plt.figure(figsize=(20, 10))
    plt.plot(x, train_ls, label='trainging loss', linewidth=2.0)

    plt.xlabel('Epoch', fontsize=24)
    plt.ylabel('Loss', fontsize=24)
    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)
    plt.title(name, fontsize=24)
    plt.grid(linestyle='-.')
    dir_display = os.path.join('./results/display', date)
    mkfile(dir_display)
    plt.savefig(os.path.join(dir_display, name_p))

    # plt.show()


def display_acc(train_acc, valid_acc, k, date):
    name = 'k' + str(k) + '_acc'
    name_p = name + '.png'
    x = []
    for i in range(len(train_acc)):
        x.append(i + 1)
    plt.cla()
    plt.close('all')
    plt.figure(figsize=(20, 10))
    a, = plt.plot(x, train_acc, label='train acc', linewidth=2.0)
    b, = plt.plot(x, valid_acc, label='test acc', linewidth=2.0)

    font1 = {
        'weight': 'normal',
        'size': 23
    }
    plt.legend(handles=[a, b], prop=font1)
    plt.xlabel('Epoch', fontsize=24)
    plt.ylabel('acc', fontsize=24)
    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)
    plt.title(name, fontsize=24)
    plt.grid(linestyle='-.')
    dir_display = os.path.join('./results/display', date)
    mkfile(dir_display)
    plt.savefig(os.path.join(dir_display, name_p))
    # plt.show()


def display_iou(train_iou, valid_iou, k, date):
    name = 'k' + str(k) + '_iou'
    name_p = name + '.png'
    x = []
    for i in range(len(train_iou)):
        x.append(i + 1)
    plt.cla()
    plt.close('all')
    plt.figure(figsize=(20, 10))
    a, = plt.plot(x, train_iou, label='train iou', linewidth=2.0)
    b, = plt.plot(x, valid_iou, label='test iou', linewidth=2.0)

    font1 = {
        'weight': 'normal',
        'size': 23
    }
    plt.legend(handles=[a, b], prop=font1)
    plt.xlabel('Epoch', fontsize=24)
    plt.ylabel('iou', fontsize=24)
    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)
    plt.title(name, fontsize=24)
    plt.grid(linestyle='-.')
    dir_display = os.path.join('./results/display', date)
    mkfile(dir_display)
    plt.savefig(os.path.join(dir_display, name_p))
    # plt.show()


def display_dice(train_dice, valid_dice, k, date):
    name = 'k' + str(k) + '_dice'
    name_p = name + '.png'
    x = []
    for i in range(len(train_dice)):
        x.append(i + 1)
    plt.cla()
    plt.close('all')
    plt.figure(figsize=(20, 10))
    a, = plt.plot(x, train_dice, label='train dice', linewidth=2.0)
    b, = plt.plot(x, valid_dice, label='test dice', linewidth=2.0)

    font1 = {
        'weight': 'normal',
        'size': 23
    }
    plt.legend(handles=[a, b], prop=font1)
    plt.xlabel('Epoch', fontsize=24)
    plt.ylabel('dice', fontsize=24)
    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)
    plt.title(name, fontsize=24)
    plt.grid(linestyle='-.')
    dir_display = os.path.join('./results/display', date)
    mkfile(dir_display)
    plt.savefig(os.path.join(dir_display, name_p))

    # plt.show()


def display_loss(train_loss, valid_loss, k):
    name = 'k' + str(k) + '_loss'
    name_p = name + '.png'
    x = []
    for i in range(len(train_loss)):
        x.append(i + 1)
    plt.cla()
    plt.close('all')
    plt.figure(figsize=(20, 10))
    a, = plt.plot(x, train_loss, label='train loss', linewidth=2.0)
    b, = plt.plot(x, valid_loss, label='test loss', linewidth=2.0)

    font1 = {
        'weight': 'normal',
        'size': 23
    }
    plt.legend(handles=[a, b], prop=font1)
    plt.xlabel('Epoch', fontsize=24)
    plt.ylabel('loss', fontsize=24)
    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)
    plt.title(name, fontsize=24)
    plt.grid(linestyle='-.')
    plt.savefig(os.path.join('/home/huangjq/PyCharmCode/4_project/1_UNet/B4_attUnetv3/results/display/0807', name_p))
    # plt.show()


def label3PIL(input_image):
    """
    这个用于标签图展示：将tensor转为黑白图片
    :param tensor: [batch=n, c ,h w]
    :return:
    """
    input_l = []
    image_tensor = input_image.data
    for i in range(image_tensor.shape[0]):
        image_numpy = image_tensor[i].cpu().float()  # image_tensor[0]: torch.Size([1, 800, 800])
        unloader = transforms.ToPILImage()
        image = image_numpy.clone()
        image = unloader(image).convert('1')
        input_l.append(image)
    return input_l


def img3PIL(input_image, imtype=np.uint8):
    input_l = []
    if isinstance(input_image, torch.Tensor):  # True
        image_tensor = input_image.data  # torch.Size([3, 3, 800, 800])
    else:
        return input_image
    for i in range(image_tensor.shape[0]):  # image_tensor.shape[0] = 3
        image_numpy = image_tensor[i].cpu().float().numpy()  # image_numpy.shape = (3, 800, 800)
        if image_numpy.shape[i] == 1:  # 若是1通道，则
            image_numpy = np.tile(image_numpy, (3, 1, 1))
        image_numpy = (np.transpose(image_numpy, (1, 2, 0)) + 1) / 2.0 * 255.0
        image_numpy = image_numpy.astype(imtype)
        image_PIL = Image.fromarray(image_numpy)
        input_l.append(image_PIL)
    return input_l


def save3PIL(k, step, cc, input_image, pred_image, groundtrue, date, picture_name):
    """
        这个函数保存的是3*3的一个网格图片
    :param step:
    :param cc:
    :param input_image:
    :param pred_image:
    :param groundtrue:
    :param date:
    :param picture_name:
    :return: 返回的是一张照片 并保存下来
    """

    # im, pr, la返回的是list,im是numpy.ndarray,pr, la是PIL
    im = img3PIL(input_image)
    pr = label3PIL(pred_image)
    la = label3PIL(groundtrue)

    dir_images = os.path.join('./results/images', date)
    dir_images = os.path.join(dir_images, 'k' + str(k))
    dir_input = os.path.join(dir_images, 'input')
    dir_output = os.path.join(dir_images, 'output')
    dir_label = os.path.join(dir_images, 'label')
    mkfile(dir_input)
    mkfile(dir_output)
    mkfile(dir_label)
    for h in range(len(im)):
        im[h].save(os.path.join(dir_input, picture_name[h]))
        pr[h].save(os.path.join(dir_output, picture_name[h]))
        la[h].save(os.path.join(dir_label, picture_name[h]))
        # cv2.imwrite(os.path.join(dir_input, picture_name[h]), im[h])
        # cv2.imwrite(os.path.join(dir_output, picture_name[h]), pr[h])
        # cv2.imwrite(os.path.join(dir_label, picture_name[h]), la[h])

    plt.cla()
    plt.close('all')
    fig = plt.figure(figsize=(15, 15))  # figsize的单位是inch

    a = fig.add_subplot(3, 3, 1)
    a.set_title('Input image', fontsize=25)
    plt.imshow(im[0])  # 显示图片
    plt.axis('off')  # 不显示坐标轴
    b = fig.add_subplot(3, 3, 2)
    b.set_title('Predict image', fontsize=25)
    plt.imshow(pr[0])
    plt.axis('off')
    c = fig.add_subplot(3, 3, 3)
    c.set_title('ground true', fontsize=25)
    plt.imshow(la[0])
    plt.axis('off')

    d = fig.add_subplot(3, 3, 4)
    plt.imshow(im[1])  # 显示图片
    plt.axis('off')  # 不显示坐标轴
    e = fig.add_subplot(3, 3, 5)
    plt.imshow(pr[1])
    plt.axis('off')
    f = fig.add_subplot(3, 3, 6)
    plt.imshow(la[1])
    plt.axis('off')

    g = fig.add_subplot(3, 3, 7)
    plt.imshow(im[2])  # 显示图片
    plt.axis('off')  # 不显示坐标轴
    h = fig.add_subplot(3, 3, 8)
    plt.imshow(pr[2])
    plt.axis('off')
    i = fig.add_subplot(3, 3, 9)
    plt.imshow(la[2])
    plt.axis('off')

    # save （一定要在show之前保存下来）
    s_dir = os.path.join('./results/picture', date)
    mkfile(s_dir)
    s_dir = os.path.join(s_dir, 'k' + str(cc + 1))
    mkfile(s_dir)
    ss = os.path.join(s_dir, str(step + 1))
    plt.savefig(ss + '.png')
    # plt.show()


def save_1_output(k, img, pred, gt, name, date):
    img = tensor2im(img)
    img = Image.fromarray(img)  # array zhuan image
    pred = labeltensor_to_PIL(pred)
    gt = labeltensor_to_PIL(gt)
    dir_images = os.path.join('./results/images', date)
    dir_images = os.path.join(dir_images, 'k' + str(k))
    dir_input = os.path.join(dir_images, 'input')
    dir_output = os.path.join(dir_images, 'output')
    dir_label = os.path.join(dir_images, 'label')
    mkfile(dir_input)
    mkfile(dir_output)
    mkfile(dir_label)
    img.save(os.path.join(dir_input, name))
    pred.save(os.path.join(dir_output, name))
    gt.save(os.path.join(dir_label, name))
    # single_picture_dir = os.path.join('./results/single_picture', date)
    # mkfile(single_picture_dir)
    # pred.save(os.path.join(single_picture_dir, name))

    plt.cla()
    plt.close('all')
    fig = plt.figure(figsize=(15, 15))  # figsize的单位是inch
    a = fig.add_subplot(1, 3, 1)
    a.set_title('Input image', fontsize=25)
    plt.imshow(img)  # 显示图片
    plt.axis('off')  # 不显示坐标轴
    b = fig.add_subplot(1, 3, 2)
    b.set_title('Predict image', fontsize=25)
    plt.imshow(pred)
    plt.axis('off')
    c = fig.add_subplot(1, 3, 3)
    c.set_title('Ground truth', fontsize=25)
    plt.imshow(gt)
    plt.axis('off')

    # save （一定要在show之前保存下来）
    picture_dir = os.path.join('./results/picture', date)
    picture_dir = os.path.join(picture_dir, 'k' + str(k))
    mkfile(picture_dir)
    ss = os.path.join(picture_dir, name)
    plt.savefig(ss)


def k_fold_acc(lisa1, lisa2):
    x = []
    for i in range(len(lisa1[0])):
        x.append(i + 1)
    plt.figure(figsize=(20, 10))
    # label2 = ['valid acc 1', 'valid acc 2', 'valid acc 3', 'valid acc 4', 'valid acc 5', 'valid acc 6', 'valid acc 7',
    #           'valid acc 8', 'valid acc 9', 'valid acc 10']
    # label1 = ['train acc 1', 'train acc 2', 'train acc 3', 'train acc 4', 'train acc 5', 'train acc 6', 'train acc 7',
    #           'train acc 8', 'train acc 9', 'train acc 10']
    for j in range(len(lisa1)):
        a, = plt.plot(x, lisa1[j], linewidth=2.0)
        b, = plt.plot(x, lisa2[j], '--', linewidth=2.0)

    font1 = {
        'weight': 'normal',
        'size': 23
    }
    plt.legend(handles=[a, b], prop=font1)
    # plt.legend(handles=[a, b], labels=["valid","train" ],  prop=font1)
    plt.xlabel('Epoch', fontsize=24)
    plt.ylabel('acc', fontsize=24)
    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)
    plt.title('name', fontsize=24)
    plt.grid(linestyle='-.')
    plt.savefig('./aaa.png')
    # plt.show()


if __name__ == '__main__':
    train_acc_epoch1 = [0.5871716944944304, 0.6437710826624263, 0.673625501513275, 0.6958680280652122,
                        0.7122473397431762, 0.7242953138179036, 0.7345875448619277, 0.7436271572779303,
                        0.7515046808595354, 0.7585967915370986, 0.7648022411163473, 0.7705930379303004,
                        0.7758692146242745, 0.7810449728189581, 0.7855173701896435, 0.7900388434502872,
                        0.793980560036557, 0.7979754548252618, 0.8015282852749279, 0.8052253909645534,
                        0.808555968242919, 0.8117185641497133, 0.8148019720249452, 0.8177430520408011,
                        0.8205416456705317, 0.8231919699627213, 0.8257374986344717, 0.8282872243021638,
                        0.8306300207313033, 0.8330498106447042, 0.835202111225058, 0.8375013702084882,
                        0.8396201272355479, 0.841677537383731, 0.8436721786376343, 0.8456199086759526,
                        0.8474357611266445, 0.8493003847242484, 0.851062775333522, 0.8527638749608828,
                        0.8543875637561877, 0.8560452952186336, 0.8576615233338858, 0.8592151730852375,
                        0.8607322602823532, 0.8622222260757513, 0.8636451828047442, 0.865047342641023,
                        0.8664649164835064, 0.8678267841163948,
                        0.8691334168297604, 0.8705041961869726, 0.8717671316723739, 0.8729775830228258,
                        0.874173371790237, 0.8753690190443218, 0.8765125442404382, 0.877656172685906,
                        0.8788177880157825, 0.8799109180000962, 0.880998459853632, 0.8820279249950549,
                        0.8830120088868755, 0.8840343109953259, 0.8849931284096999, 0.8859697025371576,
                        0.8868734590339462, 0.8878585509409537, 0.8887705915584201, 0.8896293447451794,
                        0.8904853484242745, 0.8913834647823308, 0.8922204785484988, 0.8930193932849453,
                        0.8938310040794881, 0.8946030102110638, 0.8953815757061253, 0.8961261715943175,
                        0.8968719009679683, 0.8975804582290562, 0.8982969201609564, 0.8989680427956416,
                        0.8996465745380686, 0.9003561179762003, 0.9010563446834104, 0.9017490917648695,
                        0.9023595275066374, 0.9029712487748365, 0.9035755384211285, 0.9041459553695805,
                        0.9047661668907008, 0.9053664883618869, 0.9059654240437044, 0.9065373856996445,
                        0.9071116857058606, 0.9077033398967131, 0.908263425861466, 0.9088139722804613,
                        0.9093616670664952, 0.9099172615567557]
    valid_acc_epoch1 = [0.5770554827019154, 0.6517493911134393, 0.6693603893375627, 0.6517668978071443,
                        0.7141682426099928, 0.6732819480146007, 0.7158383042028177, 0.7424633911117217,
                        0.7192110071527088, 0.7290510216865536, 0.7227618008926743, 0.7184238600695672,
                        0.744987109988279, 0.735975998026575, 0.772241044477633, 0.7657586517920495, 0.7702416437779439,
                        0.770331109787353, 0.7481960867657133, 0.7721710685142231, 0.7921363477255328,
                        0.7614955354293257, 0.7550736086317307, 0.7714507908069311, 0.7489935128174291,
                        0.763707635302522, 0.7916353624984853, 0.7862716481509463, 0.8210729521528627,
                        0.7952931075290006, 0.7900831922400535, 0.8107675428541028, 0.801888743118362,
                        0.7847677786379958, 0.8101290196993367, 0.7930097249127981, 0.8039179131201634,
                        0.8001968083666031, 0.8222254907672396, 0.8288783225240263, 0.7952895802328241,
                        0.8135302010624362, 0.7889160221417844, 0.8266582468339194, 0.7955038311023256,
                        0.7950397471385761, 0.783242458886244, 0.7924912431490047, 0.8289183155678788,
                        0.8232840052075826,
                        0.802847146552403, 0.8201388205319202, 0.821706767561379, 0.8127224396878787,
                        0.8022211994697854, 0.7978687327943339, 0.8279749908935908, 0.8230624898047055,
                        0.8447997343024783, 0.8311850354792258, 0.8175667462207543, 0.8236689845382501,
                        0.8395922181700227, 0.8319216722112955, 0.8263069047279724, 0.8454940446697324,
                        0.8083353682384602, 0.838857679591159, 0.8163573592713894, 0.8397390892783662,
                        0.8424237651559396, 0.8307693738160674, 0.8497246584801351, 0.8298981262569515,
                        0.8403113461009005, 0.7839523393402537, 0.8498365896485868, 0.838650905805527,
                        0.8558571692747913, 0.8248935803988288, 0.8227166494688762, 0.8328418786833387,
                        0.8266975606530196, 0.8279326193854777, 0.8488026084533196, 0.8198349021712492,
                        0.8474077589779345, 0.8367134253461783, 0.8138638745873051, 0.8385447298623161,
                        0.8425649365344402, 0.8493541585776547, 0.8543651331895581, 0.843266968631613,
                        0.8366068766618846, 0.8576456416892175, 0.8467311778952252, 0.8304203800172619,
                        0.8423468493319644, 0.8511424308361186]
    train_acc_epoch2 = [0.6069145291550588, 0.652051844708234, 0.6822022966384897, 0.7016677265457472,
                        0.7163564429720737, 0.7286478046997111, 0.7385075773327163, 0.7470953101406684,
                        0.7544973880487699, 0.7613335393070522, 0.7675964419951337, 0.7730921878426423,
                        0.7782150581077695, 0.7829204928788063, 0.7876425271929484, 0.7919073216316269,
                        0.7958685703300163, 0.7996299414547828, 0.8031498157963894, 0.8065165099509032,
                        0.8099421971850821, 0.8130459001594202, 0.8161185563831267, 0.8189400568261559,
                        0.8215357114001158, 0.8242068857798206, 0.8267221393168621, 0.829161516224637,
                        0.8315303836013719, 0.8338080018469746, 0.8361675344425092, 0.8383885157376709,
                        0.8404443654541692, 0.8424859050005771, 0.8443129128376177, 0.8462700283183273,
                        0.8481151565505529, 0.8498997926765759, 0.8515515776750296, 0.8533718640481799,
                        0.8550502259385668, 0.8567251279790291, 0.8582969576992922, 0.8597959067946698,
                        0.8612030561273157, 0.8627336954838722, 0.8641434525620955, 0.8655166277742181,
                        0.8668039308758754,
                        0.8682247886771863, 0.8694874621727445, 0.870725684981944, 0.8718907650985014,
                        0.873078428419148, 0.874226760175759, 0.8753620382231203, 0.8765231851510219,
                        0.8776069009482479, 0.8786976095522561, 0.879761247414594, 0.8807116617851231,
                        0.8817121773953456, 0.8827402777669726, 0.8837481407652862, 0.8847193565225723,
                        0.8857070014161176, 0.8866572484546644, 0.8875799404246648, 0.8884391722381421,
                        0.889268289235228, 0.8900981114284214, 0.890940326716587, 0.8917524613588543,
                        0.8925658655605662, 0.8933316067901301, 0.8941286888703147, 0.8949057593940299,
                        0.8956867925679114, 0.8964293196516653, 0.8971684540448613, 0.8979045955196924,
                        0.8986405011769047, 0.8993367027225619, 0.8999955870032382, 0.9006325489588526,
                        0.9013091630438028, 0.9019888572401871, 0.9026488757639145, 0.9032697420879969,
                        0.903918016725234, 0.9044826266515548, 0.9050651970643877, 0.9056672117693737,
                        0.9062504085350211, 0.9068126775023553, 0.9073859972551896, 0.9079430163849751,
                        0.9084826023056457, 0.9090320535264086, 0.909587125728696]
    valid_acc_epoch2 = [0.5762071551744722, 0.6200112221540288, 0.6432244288102724, 0.6524687763273058,
                        0.7003564272346829, 0.7076684652004152, 0.7291913509862826, 0.7329131371080756,
                        0.7298243576105008, 0.7101472357879923, 0.7409217419061619, 0.7526634580830277,
                        0.7531363397351266, 0.7179065706738748, 0.7359486380231782, 0.7669707303749478,
                        0.7633847108296181, 0.7532083164984478, 0.7615995136653028, 0.7617013659401054,
                        0.7638823708912014, 0.7296032513665683, 0.7721764747345992, 0.7741343333953872,
                        0.7982829434829949, 0.7659678342280433, 0.7499328644604418, 0.7779923288967889,
                        0.7949876936991569, 0.7724566665395529, 0.7528083356797589, 0.7882377649316049,
                        0.7956265650205969, 0.7972071064330306, 0.7735745783168629, 0.7724774051104579,
                        0.7670432062813951, 0.7729348428514616, 0.7976113608477603, 0.7940171429885164,
                        0.7939371666511712, 0.7746395178424155, 0.7918064294820766, 0.7781629942042998,
                        0.8054015512833331, 0.7990154824509027, 0.8030770841867217, 0.7496521635569323,
                        0.7707669964192962,
                        0.7649657305049883, 0.8140443882236483, 0.7953526147401648, 0.7864429782984889,
                        0.8071652596784741, 0.8066506504693399, 0.7977999489805545, 0.8264977923320963,
                        0.8023706840029519, 0.8104372108691106, 0.7543991989246487, 0.7915428591028606,
                        0.80966185055499, 0.791545341108739, 0.784068158461514, 0.8245863702193722, 0.8072642692623794,
                        0.7891910278494437, 0.8199421888308346, 0.8210846566711406, 0.8091497511073747,
                        0.8052868455251546, 0.7820148645856672, 0.8101483416572419, 0.8290091559450811,
                        0.8470930577599516, 0.8182228680897397, 0.8061564683096358, 0.8103784858354761,
                        0.8238382448173296, 0.8005677534181391, 0.8119844655600295, 0.8139608307625334,
                        0.8268341017545567, 0.7725943382195537, 0.8303486253457837, 0.8245762197951045,
                        0.8153386044844947, 0.818436886226133, 0.821071623748695, 0.7855811476024005,
                        0.8050444503063403, 0.8346098818637625, 0.8072909798374939, 0.8079554964098484,
                        0.8288016305146254, 0.824644087869115, 0.8038725245608309, 0.803474387792763,
                        0.8332797208787603, 0.8384836905895228]
    train_acc_epoch3 = [0.5742022917885821, 0.6317862652878045, 0.6662896727917959, 0.6910210060631481,
                        0.7079428771340934, 0.7207889908578924, 0.731925641661283, 0.7417790016831585,
                        0.7503752241302468, 0.7572316103264514, 0.7635404488310331, 0.7695450935861714,
                        0.7748372421761337, 0.7801148034403752, 0.7850169993270059, 0.7891462592761354,
                        0.7931637743431216, 0.7969568927741357, 0.8006583869920229, 0.8041320174834429,
                        0.8074528301956261, 0.8104844080154258, 0.8135716095213457, 0.8167384720191309,
                        0.8196597269302114, 0.8225025440785388, 0.8250772241265347, 0.8276318314591006,
                        0.8300012302263251, 0.8321818152720816, 0.8345524523294827, 0.8367077107515994,
                        0.8387524897901256, 0.8407161614422698, 0.8427516721077061, 0.8445726177883195,
                        0.846467934748706, 0.8482997992922338, 0.8500688274142632, 0.8518113094388254,
                        0.853434804640347, 0.8550588833330105, 0.8566173965443867, 0.8580617666339871,
                        0.8596072622729442, 0.8610774877768929, 0.8625381774286802, 0.8639536109915478,
                        0.8652236848518058,
                        0.8665548907374072, 0.867892069524088, 0.869197166207563, 0.8704631006478534,
                        0.8716332778431023, 0.8727938935134077, 0.8739307553678133, 0.8750976315122952,
                        0.8761858582373465, 0.8772861590581494, 0.8783943832865391, 0.8794159923171, 0.8804326801956425,
                        0.8814478260274072, 0.8824416904640351, 0.8833970687059554, 0.8843472840286725,
                        0.8853006323152801, 0.8862348353878179, 0.8870241904451758, 0.887895919734698,
                        0.8887888648192228, 0.8896634294343965, 0.8905153955821637, 0.8913298448570329,
                        0.8921498345377685, 0.8929602432109086, 0.8937330916310042, 0.8945233606245084,
                        0.8952371119863377, 0.8959734344539785, 0.8967331089827143, 0.8973902818316746,
                        0.8981052287069627, 0.8987888367823187, 0.8994318211642315, 0.9000546867518252,
                        0.9007049240953836, 0.9013531020950489, 0.9019462706577143, 0.9025792755437742,
                        0.9032110098694702, 0.9038248104630727, 0.9044235700703264, 0.9050144449161353,
                        0.9056119932687148, 0.9061556220975329, 0.9067017229883217, 0.9072708288241499,
                        0.9078055916398338, 0.9083387615402732]
    valid_acc_epoch3 = [0.6231890865610186, 0.6847895204336117, 0.6868668708216749, 0.6676909309086608,
                        0.7172302984759227, 0.7345047288889865, 0.7448255763080265, 0.7556465998427748,
                        0.7506304015135901, 0.7340128641392422, 0.7496582211856436, 0.7773588966991906,
                        0.7867636633432208, 0.7916795266160774, 0.7778959403254503, 0.7708724880267991,
                        0.7793606027682658, 0.7782397635066427, 0.7709436539704554, 0.7891505723871778,
                        0.7961313369951613, 0.7821345545220381, 0.806845558382331, 0.7938569275550909,
                        0.7952128715331109, 0.7908180749210978, 0.7884587361313428, 0.7611758186897198,
                        0.8095062993334914, 0.8006819732842385, 0.7873818682955932, 0.7830690063379331,
                        0.7836961271950937, 0.8093996030600829, 0.8193012891713504, 0.8035413038710904,
                        0.7908438144485952, 0.8129546763611474, 0.8082611857723552, 0.8264268410178359,
                        0.8105046100205243, 0.8236990153716022, 0.8112859199605496, 0.815440435007521,
                        0.8247256100257055, 0.8215274488891846, 0.8139283380342535, 0.811793321281808,
                        0.8109455187307738,
                        0.8060633515003921, 0.8147131941729541, 0.8290993273724, 0.8236434897108772, 0.8204549245538563,
                        0.8132862344355394, 0.819010021215294, 0.8183532704728504, 0.8433455510635604,
                        0.8336140015823781, 0.8162492944640628, 0.8305797983411399, 0.826217191757108,
                        0.8326208884392297, 0.839114764692139, 0.8127180383137694, 0.8302219455702216,
                        0.8288564516084924, 0.824729338604751, 0.8263418825824619, 0.8152687500424183,
                        0.8419338490195136, 0.8324641943035889, 0.8369163068216896, 0.8443572756103159,
                        0.8406135925599914, 0.8254800475366957, 0.808448483662676, 0.8235542716418572,
                        0.8414417124956257, 0.8306750913593157, 0.8389062569985276, 0.8527262600954573,
                        0.8243263348437685, 0.8481131255998672, 0.8346958863115874, 0.8460862062761233,
                        0.8437638045352013, 0.8259234305465875, 0.8161097583645861, 0.8370710151166533,
                        0.8244022586860642, 0.8428747994381406, 0.855792077683069, 0.8512627057456748,
                        0.8221161175935424, 0.8484356321726726, 0.8150998740192748, 0.847927231665233,
                        0.8215716562795954, 0.8426601553642257]
    train_acc_epoch4 = [0.5764014571611586, 0.6385113226971223, 0.6713326779837512, 0.6944976675688694,
                        0.711670462830575, 0.7254132351688962, 0.7362986690419425, 0.7461803641703403,
                        0.754785709076604, 0.7623922157951278, 0.7691603645650565, 0.7755040630390099,
                        0.7811337976138399, 0.7861702447512063, 0.7909504485969971, 0.7957995660527687,
                        0.7999034172418164, 0.8039251733850638, 0.807632014422115, 0.8111373678680676,
                        0.814559511573351, 0.8179763100596165, 0.8211220703889736, 0.8241880116249323,
                        0.8270792583814232, 0.8297739650838877, 0.8324087177031833, 0.8349974826534321,
                        0.837408719262625, 0.8398705409416553, 0.842124968809528, 0.8444234798665593,
                        0.8464958962146987, 0.8485279909908239, 0.8504972611476664, 0.8524479277677406,
                        0.8543726301208814, 0.8561908717410509, 0.8579355349725495, 0.8596342976116421,
                        0.8612204412854754, 0.8628404407688361, 0.8644180719337424, 0.8658756255391342,
                        0.8673536942676005, 0.868857566590075, 0.8702810497977506, 0.8716550050563523,
                        0.8730568542033341,
                        0.8744310678328675, 0.8757702611963032, 0.877082325310171, 0.8782943192240524,
                        0.8795319740186878, 0.8807471134202773, 0.8818547452643695, 0.8829993693531222,
                        0.8841679677845095, 0.8852161420968344, 0.886221459526191, 0.8872334407846956,
                        0.8882217826681406, 0.8891517690337271, 0.890082447726812, 0.8909570181580108,
                        0.8919428156985725, 0.892845791676142, 0.8937087258288071, 0.8946106224691046,
                        0.8954876530968296, 0.8963699458438826, 0.8972124144404088, 0.8980015867577944,
                        0.8988190536481222, 0.8996314456428429, 0.9004192137793943, 0.901162483456505,
                        0.9019056311815898, 0.9026419053712875, 0.90335102744104, 0.9040754757667234,
                        0.9047608792387988, 0.905440144611031, 0.906090671052837, 0.9067424945424936,
                        0.9074035039050508, 0.9080477064164822, 0.9086639077998041, 0.9092267607672632,
                        0.90982149964997, 0.910406532684699, 0.9109743689437065, 0.9115608045793189, 0.9121136119180846,
                        0.9126715484349583, 0.9131980157518048, 0.9136953573662595, 0.9142049897060058,
                        0.9147196257783954, 0.9152293790305464]
    valid_acc_epoch4 = [0.6069926847803849, 0.6192287565639127, 0.6995949905219608, 0.6879508404212119,
                        0.6833214056510676, 0.7145252484091904, 0.6756637863908109, 0.7254451389205474,
                        0.7535648320927606, 0.7445323866906821, 0.737219665649012, 0.7732994875022632,
                        0.7337619080921253, 0.7316871119673908, 0.7512352116671049, 0.7599318066356527,
                        0.7719082284758793, 0.7784134323157982, 0.7702095279896122, 0.7862132019159462,
                        0.774834246865125, 0.8070286072133901, 0.7900164243809789, 0.776693740722926,
                        0.7743432159141111, 0.7961565508524592, 0.789369902525372, 0.7845689000511343,
                        0.8025215351155716, 0.8077578724570246, 0.8124059469526366, 0.8044971535122162,
                        0.8105678360466806, 0.8067158313133107, 0.7882307751029917, 0.8216472888040636,
                        0.7979311048647041, 0.7940814530701591, 0.8094935194424202, 0.8141563228682821,
                        0.7985947320787854, 0.7938716837297874, 0.7837432481570411, 0.7934349072107075,
                        0.7900126562829763, 0.8234844313522374, 0.8016453148554041, 0.7801778590985486,
                        0.8060643225408259,
                        0.7916882416702381, 0.797133593512697, 0.8279056533148045, 0.8036166228539436,
                        0.8037915897403836, 0.8225915693010418, 0.8106477495413934, 0.8233698495106104,
                        0.8037500738081883, 0.8178039299066339, 0.778290612009413, 0.8079763911861066,
                        0.7829929148237131, 0.7929595194005614, 0.8005423301505536, 0.7938727705431695,
                        0.8296610378195532, 0.8240795487114022, 0.8496134527987721, 0.8194085961831739,
                        0.8104657269133392, 0.8257116749398196, 0.7881535378127518, 0.828722570740122,
                        0.8329877579558598, 0.839529842237566, 0.8375701946931364, 0.8228753786911056,
                        0.8144696193968458, 0.8433065883483613, 0.8200108028214373, 0.82505367953023,
                        0.8369818212101653, 0.81774291993589, 0.8332695288942535, 0.8374678563962803,
                        0.8181051008472893, 0.8274399052725124, 0.8276554008107232, 0.8198899300240099,
                        0.8318721872938254, 0.8197997603479698, 0.824421724114228, 0.840604811151226,
                        0.8359409484369273, 0.8436308087985783, 0.8350302680539313, 0.8317425530447684,
                        0.8373990465597099, 0.8290346704583912, 0.8441672748982464]
    train_acc_epoch5 = [0.5694821732885705, 0.6284216587883854, 0.6624716340519612, 0.6855604757579145,
                        0.702819218122981, 0.7174361145218698, 0.7290099623568866, 0.739055268416263,
                        0.7478526101928046, 0.7555818637898, 0.7624664439790082, 0.7684604019418324, 0.7739086256270541,
                        0.7792647707090032, 0.7842694072532584, 0.788746215581762, 0.7931749589708739,
                        0.7973145463036572, 0.8009332120174167, 0.8047284326334019, 0.8081066993639114,
                        0.8114447901199879, 0.8146305699377185, 0.8177777730406278, 0.8207904880252977,
                        0.8234651213178783, 0.8261376873878731, 0.828747994204037, 0.8312814187025496,
                        0.8338062295149096, 0.8360381263991997, 0.8382543580787534, 0.8404320463885026,
                        0.8424617080113552, 0.8444840281529944, 0.8464228186485152, 0.8483204759256097,
                        0.8501184267079371, 0.8519154613685189, 0.8537163395544425, 0.8554756704532528,
                        0.8570654422796855, 0.8586753625071772, 0.8601679310450475, 0.8617197213568498,
                        0.8631736811283204, 0.864593516748965, 0.8659927966174614, 0.8674015450254637,
                        0.8687396085099891,
                        0.8700738308026054, 0.8713568050948033, 0.8726003966611362, 0.8738293381016542,
                        0.8750813890150304, 0.8762728017965439, 0.8774334440066389, 0.8785157135185883,
                        0.8796252139787496, 0.8806406854615157, 0.8816944247250887, 0.8827565134645802,
                        0.8837803311903255, 0.8847794154885512, 0.8857980312885608, 0.8867447040018652,
                        0.8876690411361089, 0.888592367559977, 0.8895091336387695, 0.8903953765734149,
                        0.8912851573059064, 0.8921821493739209, 0.8929641117440582, 0.8937792478161578,
                        0.8945277555083767, 0.895288297294981, 0.8960387288903798, 0.8967934644930315,
                        0.8975352460508175, 0.8982804235257488, 0.899001513423969, 0.899694998207529,
                        0.9004174141342908, 0.9011263062277981, 0.9017931497778783, 0.9024617277072526,
                        0.9031243030329795, 0.903743990557644, 0.904361112962395, 0.9049578318872369,
                        0.9055730867155052, 0.9061362097235323, 0.9067302562854862, 0.9073216251061965,
                        0.9078762713136876, 0.9084537140958767, 0.9090288318909608, 0.9095914824404667,
                        0.9101390766218068, 0.9107091725082532]
    valid_acc_epoch5 = [0.613848391720749, 0.6782100386508993, 0.6837832877161835, 0.6812079648958007,
                        0.7028409253983348, 0.7306718199462636, 0.7607606778699731, 0.766880958836915,
                        0.7815541932144725, 0.7791624330205964, 0.7630987602619161, 0.749224503005976,
                        0.7555922316515021, 0.7667160694165785, 0.7760168553075307, 0.8231755449157272,
                        0.8074958973911809, 0.8176653143300612, 0.7831933525609034, 0.7997428410251216,
                        0.7708818058996043, 0.7997387895062534, 0.7971029357312359, 0.7900643533877724,
                        0.8215189401313928, 0.8426985553900421, 0.8424843158599558, 0.8198983773524392,
                        0.7748561667581662, 0.8264574368408113, 0.8372752833490688, 0.8217703790582641,
                        0.8224338172955621, 0.8446780872286294, 0.8256138824884391, 0.8036890545131203,
                        0.8326750854086465, 0.8226947678406624, 0.8316579404425453, 0.816971401990536,
                        0.8025103040092431, 0.8155834440951635, 0.8347727650489993, 0.8350992070411809,
                        0.8361774132163382, 0.8185441704677117, 0.826317118279382, 0.8342644667672626,
                        0.8080237701891009, 0.8388152811481365,
                        0.8142369645704909, 0.8206083822145096, 0.8290987858600698, 0.8440119202404552,
                        0.8283668547797953, 0.8282680082492233, 0.80381697405927, 0.861315070648166, 0.8503602795349552,
                        0.8348367681915612, 0.8396831816229696, 0.8484924402573207, 0.8139306677939779,
                        0.8554995961164846, 0.8354260850115174, 0.8541055569117825, 0.8360503237337952,
                        0.8376367649690927, 0.8552005193266684, 0.8341553563163093, 0.8492687590370172,
                        0.8680548858637429, 0.8323375424688817, 0.8498815655629948, 0.8489861481615486,
                        0.8464759100929556, 0.8623940837829318, 0.8593632858461002, 0.8570858653694838,
                        0.8544068498316925, 0.8467344908683768, 0.8478642185491339, 0.8322950072786044,
                        0.8476849951817066, 0.8627597554150591, 0.8550015674761217, 0.8709496519864436,
                        0.8555886254937028, 0.8510107697509974, 0.8641884458404165, 0.8583922058432953,
                        0.8596150217655589, 0.8577503233324224, 0.8706705709598817, 0.8736415180590352,
                        0.8709369520686807, 0.8496779901277626, 0.8528244459747671, 0.8636172541167894,
                        0.8797548772972311]
    train_acc_epoch6 = [0.5918397574297934, 0.6461048061958046, 0.6755691225439031, 0.6998906720425003,
                        0.7155304859933327, 0.729093602892268, 0.7398548227434497, 0.7492737962897451,
                        0.757974344948079, 0.765393865579468, 0.7716206419224282, 0.777714941191024, 0.7832334064121603,
                        0.7882052547841895, 0.7931022349549713, 0.7976286831118864, 0.801953622262057,
                        0.8058635213460438, 0.8096226823287066, 0.81311816887203, 0.8164396139419156,
                        0.8197585788885463, 0.8227698932001335, 0.8256885499758227, 0.8285966713283992,
                        0.8313070538074903, 0.8338920865748185, 0.8364786804430431, 0.8388054171496905,
                        0.8412626015338338, 0.8436057616702649, 0.8457456375031529, 0.8478744027228176,
                        0.8499006031251435, 0.8518082637393927, 0.853729067616648, 0.8555030386382785,
                        0.8571931055237648, 0.8589346008918477, 0.8607068713314283, 0.8623273041677542,
                        0.8639885502086452, 0.8656050319596403, 0.8671199428690289, 0.8686568158769592,
                        0.8701496833680689, 0.8715462230648158, 0.8729830758335314, 0.8743100356871722,
                        0.8756084399792844,
                        0.8768861907845706, 0.8780892832753809, 0.879318195543625, 0.8805432863231224,
                        0.8816510434530447, 0.882799664290147, 0.8838861710390483, 0.8849723418308841,
                        0.8860509813482405, 0.8870972309688836, 0.8880873912324543, 0.8890919855758086,
                        0.8900907275979612, 0.8910151521886764, 0.8919310841786242, 0.8928291841429804,
                        0.8937499815198449, 0.8946186641520949, 0.8954753810474412, 0.8963355170513267,
                        0.8971528445666814, 0.8979551156196406, 0.8987139637087702, 0.899443860193035,
                        0.9001808144508979, 0.9009187581421838, 0.9016757420660748, 0.9024316387532463,
                        0.9031504443024652, 0.9038615130829759, 0.9045297761492919, 0.9052112133352185,
                        0.9059004735640919, 0.9065704734667471, 0.9071785713422812, 0.9078020074306613,
                        0.9084121829473966, 0.9090103074670958, 0.9095876877354739, 0.9101851930596906,
                        0.9107059391967139, 0.9112605455107136, 0.911828312161575, 0.91239579117696, 0.9129335307148857,
                        0.9134297540503672, 0.9139459419218015, 0.9144621192386898, 0.914999575992304,
                        0.9155083845509142]
    valid_acc_epoch6 = [0.5652250039641468, 0.6079013437379662, 0.6903502337684528, 0.6818653954165643,
                        0.6949757057641612, 0.7029227429726891, 0.692828625891964, 0.7284805838547601,
                        0.7118054760522154, 0.6905220472889354, 0.7299453339327293, 0.7343152393866066,
                        0.7201419041871531, 0.7307868395376903, 0.7468859315564836, 0.7456462679155672,
                        0.7561328822813214, 0.7457349938657504, 0.7324046279929793, 0.7234423683879132,
                        0.7692212389433708, 0.7856646057021669, 0.7655612846373083, 0.7647044999855352,
                        0.7630061199090133, 0.7427575152458574, 0.7522879291576007, 0.7682173725818973,
                        0.7805016832289258, 0.7845435076344677, 0.754567279626755, 0.7998754340189563,
                        0.7807319879811401, 0.7654762345545764, 0.7672887915125579, 0.7827405906129544,
                        0.7610254459563053, 0.7851822666182106, 0.7931439003121312, 0.7883754457705843,
                        0.7782453166202293, 0.7906859238634921, 0.8057151987320822, 0.7911214786532585,
                        0.7983839862381299, 0.7770444198455396, 0.7694718649836737, 0.7512043323282026,
                        0.7793761877744185,
                        0.7959025722183614, 0.7806617119753806, 0.7465536497617213, 0.8089831306197172,
                        0.8081983234638439, 0.7661358970264283, 0.8098179470567938, 0.8007112004754434,
                        0.7794656513432677, 0.8143483289076876, 0.8212947448030234, 0.7850102681835383,
                        0.7932198987629921, 0.8216192413077557, 0.7994592257129143, 0.8093470921218979,
                        0.7949126424982081, 0.7852523973020896, 0.7681210133244731, 0.8091619221717065,
                        0.7991636218913624, 0.782481554952042, 0.7998695651048267, 0.7923151730163133,
                        0.8041226919363856, 0.805627964697838, 0.8023951574146715, 0.7986757252994731,
                        0.8112826238860795, 0.8019466641647878, 0.7784458124190882, 0.8193686716440081,
                        0.7852737837197243, 0.8247590440502726, 0.8102015982447167, 0.8173722573594047,
                        0.7929320517361603, 0.7627220694235416, 0.7940194026375967, 0.8216993044312231,
                        0.8124835139624221, 0.7924930632639254, 0.827090438965384, 0.8173426344582395,
                        0.8103463703765619, 0.8082691162281427, 0.8225393978529073, 0.8067511331594597,
                        0.8035740184660862, 0.817212494494007, 0.797503923172328]
    train_acc_epoch7 = [0.5893234835796215, 0.6409607485211115, 0.6736329771244206, 0.6943129313800795,
                        0.7099478680862255, 0.7233110255914559, 0.7342155292046951, 0.7437135273564215,
                        0.751646047931928, 0.7586191717547376, 0.765426414515155, 0.771578007470734, 0.7771704952002191,
                        0.7825739949104212, 0.787727134897457, 0.7922356493874125, 0.7964498910814907,
                        0.8004081634536132, 0.8040931565281025, 0.8076335965495657, 0.81102464836595,
                        0.8143901596293978, 0.8176302432494891, 0.8204401790930037, 0.8232681074605708,
                        0.826078586100828, 0.8287058208749488, 0.8313070313066014, 0.8338255310937455,
                        0.8361653554807871, 0.8385978813002851, 0.8407820246711963, 0.8429247034234334,
                        0.8450651215150465, 0.8470286359947403, 0.8490320349114162, 0.8509111643604229,
                        0.8527760319012567, 0.8545760269477729, 0.8562708270519352, 0.8579353417067939,
                        0.859572050112844, 0.8612332239640811, 0.862844666899313, 0.8643386425091608,
                        0.8658255432370384, 0.8673212390524392, 0.8687295124756951, 0.8700631896606155,
                        0.871441845017101,
                        0.8727273459204667, 0.8739650274003548, 0.8752522260471676, 0.876450060200392,
                        0.8776731885507889, 0.8788523786829242, 0.8799739939892931, 0.8810912266109677,
                        0.8821744940272545, 0.8832193115719454, 0.884286472502788, 0.8852968196797433,
                        0.8862634964577926, 0.8872022997704341, 0.8881316792153836, 0.8890704100694378,
                        0.8899797874766693, 0.890868223779737, 0.8917466614489352, 0.8925918033928748,
                        0.8934395239216054, 0.8942390387311868, 0.8950373044492496, 0.8958394023949928,
                        0.8966498762051436, 0.8974256026371747, 0.8981724736212536, 0.8988821149897087,
                        0.899554972386118, 0.9003049040487137, 0.9010200977229077, 0.9016927233268807,
                        0.9023607423527994, 0.9030226935616085, 0.9036780879585228, 0.9043124495063902,
                        0.9049639168160201, 0.9056177076360611, 0.9062484643397785, 0.90685496770274,
                        0.9074499407664239, 0.9080595342201779, 0.9086440554593164, 0.9092089860833417,
                        0.909777588313465, 0.9103052379178974, 0.9108389690369914, 0.9113949564520065,
                        0.9119129362527681, 0.9124294275845225]
    valid_acc_epoch7 = [0.5769120018621173, 0.6935576081176944, 0.6844346217146766, 0.7287487590472366,
                        0.7295903968480398, 0.7277882839392952, 0.7668438443678042, 0.7635624241534151,
                        0.7752527711603762, 0.7873490572765743, 0.7211364939045076, 0.7784338728679251,
                        0.8028207208499939, 0.7805793280184389, 0.7933031042968495, 0.8123253431948961,
                        0.759253475947619, 0.7842003876490946, 0.8103779644384767, 0.7940910782264149,
                        0.7894982784564454, 0.8039809066761611, 0.8182363961678903, 0.7926937483206925,
                        0.8079195662159862, 0.827814020446587, 0.77383729945909, 0.8400761051548848, 0.8268121774477432,
                        0.7858384076458802, 0.8244276782652503, 0.7813644376268859, 0.8232390220520771,
                        0.8086717952557686, 0.7838531114924987, 0.8532799327055882, 0.8160998811778994,
                        0.8279414364400419, 0.7604669869914388, 0.8258206110424282, 0.7894442793125697,
                        0.8074130503034707, 0.8410190281432577, 0.826560614647669, 0.820876742875561, 0.841110273137005,
                        0.8111335435898759, 0.8024176662841398, 0.8550855631266459, 0.7771895517588568,
                        0.8400583855883242, 0.8324391644484582, 0.8451281746309638, 0.8566461174392829,
                        0.8392443702999266, 0.8118928980471581, 0.7967759021523213, 0.8322679013112122,
                        0.8528372409787915, 0.8434507940928081, 0.8145801964190749, 0.8484410633989625,
                        0.8299773982702863, 0.8146448017983494, 0.8322140958642368, 0.8102686628948299,
                        0.8559236585648108, 0.8524038568011392, 0.8624515756749321, 0.8446080924880154,
                        0.8480947569557293, 0.8494241594070364, 0.840635037759365, 0.8505274290135256,
                        0.8695414533706715, 0.8339350201167892, 0.8406091508977174, 0.8616878582353891,
                        0.8624325181159296, 0.8686261814488299, 0.8511844248944506, 0.8337107341074386,
                        0.8588193115943135, 0.8445228846651096, 0.8493805633883562, 0.8637507312582435,
                        0.8588606866631646, 0.8693859000056859, 0.8493221958188026, 0.8410698062837835,
                        0.8337786382763918, 0.8642127534239745, 0.8785385292024376, 0.8542112892216006,
                        0.8593972193376483, 0.8581038452618698, 0.8657404121356786, 0.8618340730391975,
                        0.8714419279298073, 0.8582642449416888]
    train_acc_epoch8 = [0.5810264812755184, 0.6380967363615474, 0.6696318898462159, 0.6933323062678015,
                        0.7121025534507611, 0.724810886130986, 0.7355779814921702, 0.744730852229063,
                        0.7531635441070541, 0.7606941595678244, 0.7673341900888067, 0.7733885747050604,
                        0.778971161124429, 0.7842060718941137, 0.7888696592332779, 0.7933874020197018,
                        0.7974947087215226, 0.801491579877766, 0.8050971049668044, 0.8085288759460825,
                        0.811786582148509, 0.8151125161887955, 0.8182164875912252, 0.8211584884174967,
                        0.8240606866171956, 0.8270536731201834, 0.8296807988394149, 0.8322287897182931,
                        0.8345793209596747, 0.8369069073010431, 0.839047804234813, 0.8411736955904743,
                        0.8431912186390501, 0.8452154683880886, 0.8471312359503604, 0.8489596444010709,
                        0.8507986016762727, 0.8525598015059701, 0.8543702268711075, 0.8560426518257533,
                        0.8576668811879347, 0.8592522710465987, 0.860813422839664, 0.8623380042917149,
                        0.8638215428016387, 0.8652731559483741, 0.8666717816344759, 0.8681028081138009,
                        0.8694895201431341, 0.8707825948903227,
                        0.8720521949913943, 0.8733747094382049, 0.8745498560762143, 0.8758405124934543,
                        0.876987755854111, 0.8781686320024352, 0.8793262389767205, 0.8803814722337819,
                        0.8814749618220596, 0.8825648143639727, 0.8836251902447546, 0.8846423799311277,
                        0.8856450815848685, 0.8866408707310749, 0.8876037372131084, 0.8885395154542308,
                        0.889429253017711, 0.890345512834175, 0.8912502915506698, 0.8921110199605146,
                        0.8929573152359138, 0.8938247367576826, 0.8946580825308822, 0.895459270644999,
                        0.8962170079100314, 0.8969743909777834, 0.8977638757143914, 0.8985502893426962,
                        0.8992633826947637, 0.8999688612675019, 0.9006770755701329, 0.9013569127037944,
                        0.9020504940890696, 0.9027298267390023, 0.9034268872805169, 0.9040960828132777,
                        0.9047236496395532, 0.9053510592290792, 0.9059828223538176, 0.906601252296322,
                        0.9071898197209285, 0.9077771576278729, 0.9083594846529597, 0.908915643292587,
                        0.9094708115374904, 0.9100151143969941, 0.9105583101398416, 0.9110706421033866,
                        0.9115683581927299, 0.9120366524662029]
    valid_acc_epoch8 = [0.5621954080116978, 0.6009485599725951, 0.6862744438466818, 0.6928067011886506,
                        0.6654476949518572, 0.7078525874407876, 0.7332343844009084, 0.7448266393051054,
                        0.7071775064197057, 0.7534198624039804, 0.7489975238817789, 0.7119527144326762,
                        0.7594657150844033, 0.7284604528747808, 0.7867008134915943, 0.6972258685673424,
                        0.7816127368302354, 0.8012749447779597, 0.774236498961511, 0.7821597005523725,
                        0.7339802268591895, 0.7825296772276744, 0.7533399657613632, 0.7891703805104788,
                        0.8083871937036655, 0.7747107742464776, 0.7536976330763274, 0.8051500125671578,
                        0.7634224533867284, 0.7751700979951136, 0.7928411734152229, 0.7321624599693527,
                        0.8325577979152715, 0.8014239201511825, 0.7495030773385829, 0.7732553589792646,
                        0.7976776156259237, 0.7610496708699966, 0.7763766829058095, 0.8008244636541191,
                        0.7908289731864719, 0.7766859665306876, 0.7618284310416211, 0.8353645331370536,
                        0.7799733871747496, 0.794114470249821, 0.7955192341035671, 0.7810034603472702,
                        0.7975188443391336, 0.7857775032787545,
                        0.8110514726307777, 0.7799642869121342, 0.8291761399335588, 0.8055095229487563,
                        0.8222423462772759, 0.7933483269908459, 0.825407198281441, 0.7892230952896899,
                        0.8063417342944592, 0.8362328522162883, 0.8057203470776796, 0.7898084400530091,
                        0.8157973727954834, 0.7927276696244114, 0.8331381126136104, 0.8113813502867012,
                        0.8265777372045489, 0.7875813957818457, 0.8165800162730086, 0.8405452712912462,
                        0.8331464816462644, 0.7851454183635499, 0.8174542202410129, 0.8481658926310744,
                        0.8066359227449653, 0.821204973347968, 0.823085288827705, 0.8156993532073336,
                        0.8233244621708208, 0.8201284502077211, 0.8370484874564902, 0.8364224549595295,
                        0.8311191305596785, 0.8351552692871123, 0.8361166895813764, 0.8335367028132484,
                        0.8263606822392178, 0.8397904919357125, 0.8403643584007783, 0.8271404988455844,
                        0.8486985875713745, 0.8300424144470355, 0.8439664280281852, 0.8161042359123603,
                        0.8483550541900666, 0.8018691411849842, 0.8479500009697608, 0.8346504625857725,
                        0.8458105850260311, 0.8236541215301224]
    train_acc_epoch9 = [0.5652532750960202, 0.6331465854826483, 0.669789177176268, 0.6950522472602414,
                        0.7132110124462491, 0.7271648948959862, 0.7392806729919782, 0.7493216185955164,
                        0.757456523939524, 0.7644389557630732, 0.7709335741295008, 0.7768590258376274,
                        0.7821871880441803, 0.7873264775324089, 0.7919601751300862, 0.7963086487231507,
                        0.8002178725231733, 0.8043149300970364, 0.8080335807747824, 0.8115735696497465,
                        0.8148263151713696, 0.8180967137811059, 0.8210705033718834, 0.8239778703661745,
                        0.826692932589956, 0.8291566758253736, 0.8317864126060112, 0.8340148101199526,
                        0.8363116226134917, 0.8385659320357269, 0.8408200155386576, 0.8428493844905905,
                        0.8448386957665361, 0.8467788029916034, 0.8487069913246258, 0.8505118540023658,
                        0.8523190965255136, 0.8540102829296106, 0.8557202128125431, 0.8573515456503614,
                        0.8589191167694641, 0.8604359098891576, 0.8619178470788854, 0.863372804184072,
                        0.8647789192393976, 0.8661525915483377, 0.8675022846878013, 0.8688050020324634,
                        0.8701538045088726, 0.87134381303906,
                        0.8725840406041095, 0.8737869761075042, 0.8749551309068255, 0.8761418953488541,
                        0.8772483785994486, 0.8783784858611312, 0.8794695223096272, 0.8805393638631829,
                        0.8816038150912042, 0.8826677520137423, 0.8836438046844208, 0.8846346411400153,
                        0.8856118308284853, 0.8864927394573598, 0.8874072443765179, 0.8882915857204938,
                        0.8891609278435443, 0.8899972065549321, 0.8907966463177832, 0.8916264827767949,
                        0.8924402050574038, 0.8931977856485873, 0.8940094556290201, 0.894778212761441,
                        0.8955599501863241, 0.8963012188471542, 0.8970255064004619, 0.8976894865274755,
                        0.898345362420495, 0.8989789975228846, 0.8996529623175757, 0.9003387791818217,
                        0.9010201678941753, 0.9016862744180031, 0.902336714821794, 0.9029942526375221,
                        0.9036309057058342, 0.9042320688996368, 0.9048118478243238, 0.9054094929492162,
                        0.9059779189559088, 0.9065333474508159, 0.9070916683768645, 0.9076797928592241,
                        0.9082206427603075, 0.9087958113899435, 0.9093252407858184, 0.9098311674773903,
                        0.9103552685207039, 0.9108773676708435]
    valid_acc_epoch9 = [0.5730968424521681, 0.634697886173583, 0.629788601256796, 0.6643925952318094,
                        0.6960457819181766, 0.7337885635529404, 0.7247886108038756, 0.6760407804749902,
                        0.7243839224456287, 0.7367142136797784, 0.7200092697969793, 0.7014783340620988,
                        0.7430044392963321, 0.7443507888344388, 0.7589440846023906, 0.7302107467687882,
                        0.7412125216452995, 0.7060915602956588, 0.7521610515912013, 0.7221074004191885,
                        0.7670582327743988, 0.7375109653027893, 0.7605712121674186, 0.7614589661363338,
                        0.7650869852726381, 0.7588786814654003, 0.7525714310837196, 0.7593977104920424,
                        0.770389792100182, 0.754180499482447, 0.7782043759140537, 0.7619575445977612,
                        0.7653710824555843, 0.7848687311166941, 0.7670771665320087, 0.7476752774833472,
                        0.7797905758521638, 0.7604114841255758, 0.7783191729216279, 0.7545277962839398,
                        0.7501917400143887, 0.7413976116246158, 0.8009298374428563, 0.7751375728308956,
                        0.7910134180228667, 0.7632458445529048, 0.7875128105013788, 0.7963411124356488,
                        0.7698821473227782, 0.764896129904037,
                        0.7834625020425052, 0.7635696048113609, 0.7788602806943627, 0.769050674767536,
                        0.7923405256739049, 0.7950336389210727, 0.7987575327037394, 0.7760265571623338,
                        0.7680448983049856, 0.7773223776636883, 0.7656211219737814, 0.8030132948991527,
                        0.7974680309478205, 0.8130266285258223, 0.7860678004423874, 0.7884690714117881,
                        0.7858577168707641, 0.7999858026086649, 0.784327909385051, 0.7824169233764949,
                        0.7968604100926585, 0.7572409156251415, 0.8021164089281051, 0.7978209052208268,
                        0.7875013972099196, 0.7779244177939083, 0.7984527779820376, 0.7505451353378695,
                        0.8003540686343673, 0.7891737282012997, 0.7997545927428287, 0.8036218091589966,
                        0.8124422319428607, 0.8220691910100567, 0.8070638865734022, 0.7704751866903305,
                        0.7805658008397852, 0.7648946519292704, 0.8249258824025503, 0.8043211288394515,
                        0.784395366445918, 0.7808543841071232, 0.7727418208873066, 0.77843542172369, 0.8029820036111712,
                        0.8190908958939263, 0.8010937977729603, 0.8135300633267738, 0.7955797992302981,
                        0.7900479291903311]
    train_acc_epoch10 = [0.5797935909359377, 0.630685278239891, 0.6642940097219758, 0.6869049797662197,
                         0.703927360268578, 0.7173853912990374, 0.7297475765536169, 0.7389949473708545,
                         0.7476572653275466, 0.7553234303770578, 0.7621747738953715, 0.7684289342480572,
                         0.7744626908748793, 0.7800330611417906, 0.7850826227499951, 0.7897743361805634,
                         0.7941787874405786, 0.7981043267268192, 0.8021174256325698, 0.805636534395792,
                         0.8090950472935551, 0.8124860930879355, 0.8156420681865618, 0.8185102795036868,
                         0.821484658455758, 0.8242744489564126, 0.8269176783428062, 0.8294669596666103,
                         0.8320555519786786, 0.8344156206549083, 0.8367610309502613, 0.839008573916801,
                         0.8412203564502888, 0.8432736173590754, 0.8453825283278741, 0.8472889461557475,
                         0.8491565072414559, 0.8509999353214468, 0.8527762394464987, 0.8545464331959094,
                         0.8562911819181191, 0.8579182255959011, 0.8595324404857086, 0.8611290437011256,
                         0.8627449054360458, 0.8641913770440467, 0.8656382817191611, 0.8670116621614082,
                         0.8684468242378595,
                         0.8697973060336368, 0.8711000817885198, 0.872364242466149, 0.8736606115790524,
                         0.874881601494007, 0.8760076970468238, 0.8771764495414369, 0.8782949581802013,
                         0.879363755506672, 0.8805064948669853, 0.8816275514635267, 0.8826795529468362,
                         0.8837367358967759, 0.8846913898939901, 0.8856043849710435, 0.8865739339737391,
                         0.8874841152866496, 0.8884572454062065, 0.889389840009642, 0.8902722395577098,
                         0.8911690486960924, 0.892023470618853, 0.8928394987705336, 0.8937143519060897,
                         0.8945478086310291, 0.8953882015575236, 0.8961958776866935, 0.8969540632035738,
                         0.8977005417894545, 0.8983717356947352, 0.8990905269427638, 0.8998111244249777,
                         0.9005190665438493, 0.9012175060538147, 0.9019064755141998, 0.9025906340243305,
                         0.9032746819456482, 0.9039161720741121, 0.9045657639982736, 0.9052091699855681,
                         0.905843829662029, 0.9064374857457272, 0.9070026132637498, 0.9075985800547607,
                         0.9081797550058526, 0.9087745745859639, 0.9093415936552188, 0.9099041156453952,
                         0.9104618644474338, 0.9110161264987122, 0.9115751081169995]
    valid_acc_epoch10 = [0.6043963447139373, 0.6230712155018159, 0.6603774085685369, 0.6769083508680253,
                         0.7078593992308347, 0.7299578898328108, 0.7312619845195375, 0.7510522750460098,
                         0.7609953318995899, 0.7296271429188859, 0.7860265399813753, 0.7705478053732563,
                         0.7587453094999645, 0.7804321844083205, 0.7879683818866968, 0.8195025697335535,
                         0.7942863168010689, 0.780947832355976, 0.8159274337808387, 0.7732503969290714,
                         0.7800528136205662, 0.8199112114444941, 0.7668277217170031, 0.8048815927333005,
                         0.8039548686161357, 0.8097623762202087, 0.8187778343229511, 0.8172465750828125,
                         0.8234441887987732, 0.7935332781489938, 0.8230952666143346, 0.8100532149395202,
                         0.7870056444340641, 0.7902402521199205, 0.8181206166545159, 0.8111315604036357,
                         0.8195354729238626, 0.8234476546679779, 0.8119039031743047, 0.8221795908250453,
                         0.7929157525928477, 0.8148453014215274, 0.7925800878836721, 0.812789425478655,
                         0.8067370487775676, 0.8403830460946996, 0.8293401063728847, 0.8079476346006431,
                         0.8479720037387597, 0.8256858013344022,
                         0.8006120408261319, 0.8046246695954669, 0.8372216797188875, 0.8082985334404644,
                         0.8162525282778504, 0.8302900717211056, 0.8226280795625368, 0.7975183368131803,
                         0.8205497542798692, 0.806049453383434, 0.8159534730557695, 0.8321806572738484,
                         0.8247528122141417, 0.8343208634080939, 0.8425241576704304, 0.8483879625908264,
                         0.8350279249610696, 0.8490055233496168, 0.8210015177392124, 0.8262976002060272,
                         0.8274055349847754, 0.8262114027979883, 0.8276291266595933, 0.8349517739463783,
                         0.8282506192631616, 0.8456149981804272, 0.8523310899979215, 0.8275411239051174,
                         0.8352493188699321, 0.8186309699742715, 0.8400332558755009, 0.8556808342478661,
                         0.826682208555778, 0.813514786538264, 0.8748922794226375, 0.8440945579214428,
                         0.8320248168471186, 0.8147552677851526, 0.8558782785608655, 0.8461817716156527,
                         0.8326999299322602, 0.8198061784845483, 0.8382564654312452, 0.8421987316655651,
                         0.8590945479528085, 0.836687873128425, 0.8265180931611488, 0.8363423354706836,
                         0.8438954756543464, 0.8507898156224809]
    lisa1 = [train_acc_epoch1, train_acc_epoch2,
             train_acc_epoch3, train_acc_epoch4,
             train_acc_epoch5, train_acc_epoch6,
             train_acc_epoch7, train_acc_epoch8,
             train_acc_epoch9, train_acc_epoch10
             ]
    lisa2 = [valid_acc_epoch1, valid_acc_epoch2,
             valid_acc_epoch3, valid_acc_epoch4,
             valid_acc_epoch5, valid_acc_epoch6,
             valid_acc_epoch7, valid_acc_epoch8,
             valid_acc_epoch9, valid_acc_epoch10
             ]
    k_fold_acc(lisa1, lisa2)
